<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mycompany.miniproject.dao.ProductDAO">

	<select id="selectNewProduct" resultType="Product" >
		<![CDATA[
			SELECT
				product_id,
				product_name,
				product_price,
				product_datetime
			FROM 
				(SELECT
					product_id,
					product_name,
					product_price,
					product_datetime
				FROM 
					PRODUCT
				ORDER BY product_datetime DESC, product_name)
			WHERE
				rownum <= 8
		]]>
	</select>
	
	<select id="selectProductImage" resultType="Product" parameterType="Product">
		<![CDATA[
			SELECT
				product_id,
				product_usecase,
				image_original_name,
				image_type,
				image_data
			FROM
				PRODUCT_IMAGE
			WHERE
				product_id = #{productId}
			AND product_usecase = #{productUsecase}
		]]>
	</select>
	
	<select id="selectBestProduct" resultType="Product">
		<![CDATA[
			SELECT 
				product_id, 
				product_name, 
				product_price, 
				order_product_count
			FROM (
			    SELECT 
			    		p.product_id, 
			    		p.product_name, 
			    		p.product_price, 
			    		op.order_product_count
			    FROM 
			    		order_product op
			    LEFT OUTER JOIN 
			    		product p
			    ON 
			    		p.product_id = op.product_id
			    ORDER BY 
			    		op.order_product_count DESC
			)
				WHERE 
					rownum <= 8
		]]>
		
	</select>
	
	<select id="selectRecomProduct" resultType="Product">
    <![CDATA[
        SELECT *
        FROM (
            SELECT 
                product_id, 
                product_name, 
                product_price
            FROM 
                product
            ORDER BY 
                DBMS_RANDOM.VALUE
        )
        WHERE rownum <= 8
    ]]>
</select>


	
	
</mapper>